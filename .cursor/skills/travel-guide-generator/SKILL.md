---
name: travel-guide-generator
description: 通过多轮对话收集用户旅行信息（含完成度百分比）、在旅游网站与社交媒体搜集资料、输出精细化日程 MD 供确认、再按目的地与季节生成配色并产出 HTML 攻略页。适用于用户要做「某地某季旅游攻略网站」或「按日按时段吃喝玩乐攻略」时使用。
---

# 旅游攻略生成器

按**四阶段**执行：信息收集（多轮+完成度）→ 资料搜集 → MD 输出与确认 → HTML 生成。

---

## 易用性：快捷入口与分步执行

- **快捷触发**：用户说「帮我做 xxx 攻略」「做一份 xxx 旅游攻略」「按攻略 skill 来」即进入本流程；首轮先给**阶段说明**与**信息完成度 0%**，再问 1～2 个最核心项（目的地、日期）。
- **阶段话术**：每次阶段切换时明确告知用户，例如：「信息已够，开始查资料」「资料整理完，下面输出 MD 供你确认」「你确认后我按这套配色生成 HTML」。
- **分步执行**：用户可说「先只做到 MD」「跳过搜集直接写」「我改完 MD 了，直接生成 HTML」；按用户指令执行对应阶段，不强制四步走完。
- **预填模板**：若用户希望少轮对话，可提供一句说明：「你可以复制下面填空，一次发给我，我会按填写项算完成度。」模板见 [reference.md](reference.md)「信息预填模板」。

---

## 阶段一：多轮对话与信息收集（完成度百分比）

### 必采字段与权重（用于计算完成度）

| 字段 | 权重 | 说明 |
|------|------|------|
| 目的地（国家/城市/地区） | 15% | 必填，可多城市 |
| 出行日期/天数（起止或「第几天」） | 15% | 必填 |
| 出行季节/月份 | 5% | 用于配色与穿衣建议 |
| 偏好类型（美食/人文/自然/购物/亲子等） | 10% | 可多选 |
| 预算档次（经济/舒适/轻奢等） | 5% | 可选 |
| 交通方式与节点（航班、火车、自驾、机场/车站） | 10% | 尽量明确 |
| 住宿区域或已定酒店 | 5% | 可选 |
| 必去/必吃清单 | 10% | 景点、餐厅、活动 |
| 禁忌与限制（不吃、不去、身体限制） | 5% | 可选 |
| 特殊需求（签证、退税、防盗、预约等） | 10% | 可选 |
| 地图偏好（境内/境外） | 5% | 默认：境内→高德，境外→Google |
| 其他备注 | 5% | 自由补充 |

**完成度计算**：已明确填写的字段权重之和；未提及的字段计 0。目标 ≥85% 再进入阶段二，不足则继续追问并标出「仍缺：xxx」。用户若对某字段说「随便/你定」，可按常见默认计入完成度但不写死内容，后续搜集时再补。

每轮回复中**必须**给出当前完成度，例如：

```
📊 信息完成度：70%
已明确：目的地、日期与天数、季节、偏好类型
仍缺：交通节点、必去清单、特殊需求（建议补充防盗/退税/预约等）
```

追问时一次只问 1～3 个相关项，避免一次抛出一大串问题。

---

## 阶段二：资料搜集

在用户信息充足（≥85%）后，进行**外部信息搜集**。渠道与检索策略见 [reference.md](reference.md)「搜索渠道分类」与「精准检索式建议」。

**原则**：按信息类型选择渠道与关键词；重要信息（开放时间、门票、预约链接）尽量**两处来源交叉验证**；每条可写进攻略的要点尽量标注**来源与时效**（如「据 TripAdvisor 2025」「小红书近期」）。

使用 `WebSearch`、`mcp_web_fetch` 等工具，将结果整理成可写入攻略的要点（时间段、店名、地址、人均、评分、注意事项）。

---

## 阶段三：输出 MD 与用户确认

### MD 结构要求（易读优先）

- **文档导航**：标题下增加「目录」区块，用锚点链接到每日（`## 🗓️ 月/日`），便于跳转。
- **标题与副标题**：目的地 + 时间范围 + 一句话主题。
- **一页速览表**（可选）：表格列「日期 | 早餐 | 上午 | 午餐 | 下午 | 晚餐 | 备注」，每格一句话，方便快速扫一眼整天安排。
- **行程概览表**：每行「日期 + 当日主题」。
- **重要提示**：防盗/退税/预约/交通/文化等 3～5 条。
- **每日区块**：按「天」分节，每天内按**时间段**细分（如 08:00–10:00、10:00–12:30）。
- **每段时间块必须包含**：
  - **核心行动**（一句话）
  - **最优项**：店名/景点名 + 简短理由 + 位置/路线 + 可选评分 ⭐
  - **备选行动项**：2～4 个同类型替代，格式一致。
- **吃喝玩乐**：每天至少覆盖早/午/晚与景点或活动，避免某天只有「玩」没有「吃」或反之。
- **统一图标**：⏰ 时间段、📍 位置、💰 人均/预算、⚠️ 注意、📸 拍摄点、🔗 链接；同一类信息全篇用同一图标，提升扫读效率。

### 地点与地图链接

- **中国境内**：使用高德地图。MD 中写 `[地点名](https://uri.amap.com/search?keyword=地点名)`，读者可直接点开；HTML 阶段再统一为高德跳转。
- **中国境外**：MD 中写 `[地点名](https://www.google.com/maps/search/?api=1&query=地点名)` 或保留「**地点名**」+ 📍 说明，HTML 中改为 `openMap('地点名')` 跳转。

### 输出与确认

- 将完整攻略写入一份 **`.md`** 文件，放在用户指定的项目目录。
- 明确告知用户：「请确认内容与时间段、地点、餐厅是否需增删改；确认后再进行阶段四生成 HTML。」

---

## 阶段四：按目的地与季节生成 HTML

### 配色规则（目的地 + 季节）

参考 [reference.md](reference.md) 中的「目的地与季节配色表」。先确定「目的地类型」与「季节」，选取主色、渐变、边框/强调色、背景色，整页统一一套变量。

### HTML 结构要求（丰富且一致）

- `lang="zh-CN"`，viewport，标题为「目的地 + 时间 + 攻略」。
- **首页元信息卡片**（在副标题下、概览卡片前）：可选展示「目的地 | 出行日期 | 天数 | 建议人数/预算区间 | 标签（如美食/人文/自然）」等，便于一眼识别攻略属性；用简洁表格或标签样式。
- **固定顶栏**：`header` + `nav`，链接到 `#home` 与各 `#day1`、`#day2`…
- **首页区块** `#home`：大标题、副标题、元信息（可选）、行程概览卡片（`overview`）、重要提示框（`tips`）。
- **每日区块** `day-section`：`h2` 日期与主题，多个 `time-block`（时间段、核心行动、最优项、备选列表）。
- **可选增强模块**（有内容时尽量加上）：当日/全程**交通时刻小表**（如火车班次）、**预算/花费汇总**（总览或按日）、**紧急联系**（报警/使领馆/急救）固定块、**图片位**（`img/` 下图片 + `loading="lazy"`，无图可占位或省略）。
- **地点可点击**：
  - **中国境内**：`<a href="https://uri.amap.com/search?keyword=地点名" target="_blank" rel="noopener" class="loc">地点名</a>`。
  - **中国境外**：`<span class="loc" onclick="openMap('地点名')">地点名</span>`，页面底部 JS：`function openMap(loc){ window.open('https://www.google.com/maps/search/?api=1&query='+encodeURIComponent(loc),'_blank'); }`
- **返回顶部**：固定右下角按钮，滚动后显示，平滑回顶。
- **锚点**：站内 `#` 链接平滑滚动；移动端触摸友好（按钮与 `.loc` 有足够点击区域）。

### 与现有项目保持一致

- 复用日本（snow）、意大利（anti-theft）的 CSS 结构：`.container`、`.day-section`、`.time-block`、`.best`、`.alt-title`、`.alt-list`、`.tips`、`.loc`、`.back-to-top` 等，仅替换颜色变量与内容。
- 图片放于 `img/`，使用 `loading="lazy"`；若无图可占位或省略。

生成完成后，将 **index.html** 放在与对应 MD 同目录下，并提示用户可在浏览器中打开；境内/境外地图说明已按高德/Google 配置。

---

## 简要流程小结

1. **多轮对话** → 按必采字段追问，每次回复带**完成度百分比**，≥85% 进入下一阶段。
2. **资料搜集** → 旅游网站 + 社交媒体，整理成景点/餐厅/时间/注意事项。
3. **输出 MD** → 按日按时段、吃喝玩乐、地点可地图化；用户确认后再继续。
4. **生成 HTML** → 按目的地与季节选配色，生成单页攻略，地点境内高德、境外 Google，样式与现有攻略站统一。

更多细节（必采字段清单、配色表、MD/HTML 片段示例）见 [reference.md](reference.md).
